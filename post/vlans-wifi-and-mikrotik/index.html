<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VLANs, Wifi and Mikrotik | Tiernan&#39;s Comms Closet</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">VLANs, Wifi and Mikrotik</span></h1>

<h2 class="date">2015/05/10</h2>
</div>

<main>
<p>About a month ago, while i was recovering from surgery, i attended a Webinar on
<a href="http://www.meraki.com">Cisco Meraki</a> devices. After the webinar, i was contacted by Maraki and given a <a href="https://meraki.cisco.com/products/wireless/mr18">MR18</a> with a 3 year license, to play with and evaluate. So, i set it up in the house and all was good.</p>

<p>Thing is, the wifi in the house was grand previously. I have a <a href="http://routerboard.com/RB951G-2HnD">Routerboard RB951G</a> which does the job and has no issues. And because i am mostly offsite in the office i work, and because i need to remotely manage the network, the MR18 is going into the office from tomorrow morning. I may talk about the MR18 and the rest of the Meraki gear later on, but this is not that post. This post is about something the MR18 did, and i wanted to do on the RB951.</p>

<p>So, the MR18 allows you to create multiple Wifi SSIDs, each with different encryption and security and can use different VLANs. Now, the Mikrotik does the same, but the VLANs stuff is not that easy to figure out. but essentially, what i needed to do was as follows:</p>

<p>create your new wifi SSIDs:</p>

<pre><code>/interface wireless
add master-interface=wlan1 name=wlan1.10 ssid=vlan10
add master-interface=wlan1 name=wlan1.20 ssid=vlan20
</code></pre>

<p>next, create your vlans. these need to be connected back to your main
ethernet connection. In the case of my RB951, there are 5 ethernet
ports. 1 is the gateway back to my Cisco switch and on to my <a href="http://www.pfsense.org">PFSense</a> router. 2-5 are all slaves of number 1, which is a master. So, 1 is essentially a trunk network. So, vlans are created on that.</p>

<pre><code>/interface vlan
add name=vlan10 interface=ether1-gateway name=ether1.10 vlan-id=10
add name=vlan20 interface=ether1-gateway name=ether1.20 vlan-id=20
</code></pre>

<p>next, a bridge to connect them</p>

<pre><code>/interface bridge
add name=vlan10
add name=vlan20
</code></pre>

<p>and connect them to the bridge</p>

<pre><code>/interface bridge port
add bridge=vlan10 interface ether1.10
add bridge=vlan10 interface wlan1.10
add bridge=vlan20 interface ether1.20
add bridge=vlan20 interface wlan1.20
</code></pre>

<p>And thats all i needed to do. I have a <a href="https://www.sophos.com/en-us/products/free-tools/sophos-utm-home-edition.aspx">Sophos UTM Home edition</a> running on a vm for testing, which vlan10 is connected to. It has an upstream connection back to the PFSense box, which has it firewalled off and allows it outside the network, not nothing else. I am planning on doing this with other firewalls, just to do some testing with. This allows me to connect my phone or laptop, or any other wifi device, to a given wifi connection and then be on my way. I also have an older Dell PowerConnect switch, which, if i ever get around to it, will have multiple connections back to the Cisco and then allow physical devices to connect to different vlans.</p>

<p>Any questions, comments, etc, leave a comment blow.</p>

</main>

  <footer>
  
  
  </footer>
  </body>
</html>

