<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2 Cable Modems = Double Speed? Part 4</title>

    
    
    
    <link rel="preload" href="https://www.tiernanotoole.ie/styles.css" as="style" />

    <link rel="dns-prefetch" href="https://maxcdn.bootstrapcdn.com/" />
    <link rel="preconnect" href="https://maxcdn.bootstrapcdn.com/" />
    <link rel="preload" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" as="style">

    

    <meta name="description" itemprop="description" content="[NOTE] This part 4 in a series of posts. The rest can be found here. So, this week I went in a completely different direction that I have been thinking recently&amp;hellip; So, the basic theory is as follows:  I am still using MPTCP kernels on both upstream and local machine now have 2 P2P UDP OpenVPN tunnels between house and cloud. Example config is here all TCP traffic (bar port 80) that hits the router in house is redirected to RedSocks RedSocks uses a socks server, Dante, as an upstream server on the cloud box since the socks traffic is over TCP (inside the UDP OpenVPN tunnel) it uses MPTCP having socks running, gives me quite the download speed, turning it off does not, hence the following tweet  Hmmmm&amp;hellip; If I have socks on, the Internet is fast 400mb/s&#43;)." id="desc"><meta name="generator" content="Hugo 0.42.1" /><meta name="keywords" itemprop="keywords" content="Guide,Networking,IPv6,Projects,HowTo,HomeLab,Double_Internet" id="keywords"><link rel="canonical" href="https://www.tiernanotoole.ie/post/2-cable-modems-double-speed-part-4/">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    
  <link rel="stylesheet" type="text/css" href="https://www.tiernanotoole.ie/css/dark.css"><link rel="stylesheet" type="text/css" href="https://www.tiernanotoole.ie/styles.css">

    <script>var _paq = undefined;</script></head>
  <body itemscope itemtype="http://schema.org/WebPage">
    <div id="site-container">
      <div id="site-header">
        <a href="https://www.tiernanotoole.ie/">
          <header class="small-text-center medium-text-left row">
            <div class="row-item">
              <span id="site-title" itemprop="name">Tiernan&#39;s Comms Closet </span>
              <br/><span id="site-tagline">homepage of Tiernan OToole, Geek, photographer, GeekPhotographer, and lazy git.</span>
            </div>
          </header>
        </a>
        </div>
      <div id="main-container" class="row" role="main" itemprop="mainContentOfPage">
        
        
        
<main class="row-item small-full medium-two-thirds" >
  <article id="post-article" itemscope itemtype="http://schema.org/Article" itemref="keywords desc">
    <header id="page-header">
      <h1 itemprop="headline">2 Cable Modems = Double Speed? Part 4</h1><p id="post-metadata" class="row"><span class="row-item">
          <span class="fa fa-clock-o"></span>
          <strong>Published:</strong>
          <time datetime="2016-04-14" content="2016-04-14" itemprop="datePublished">April 14, 2016</time>
        </span><span class="row-item"><span class="fa fa-book"></span> <strong>Estimated reading time:</strong> ~<span itemprop="timeRequired">2 minutes</span></span></p>
      
    </header>
    
    <div id="post-content">
      <span itemprop="articleBody"><p>[NOTE] This part 4 in a series of posts. The rest can be found <a href="https://www.tiernanotoole.ie/tag/Double%Internet/">here</a>.</p>

<p>So, this week I went in a completely different direction that I have been thinking recently&hellip;</p>

<p>So, the basic theory is as follows:</p>

<ul>
<li>I am still using MPTCP kernels on both upstream and local machine</li>
<li>now have 2 P2P UDP <a href="http://www.openvpn.net">OpenVPN</a> tunnels between house and cloud. Example config is <a href="https://gist.github.com/tiernano/09c6928d1d8f6752ea84fd895451bbe5">here</a></li>
<li>all TCP traffic (bar port 80) that hits the router in house is redirected to <a href="https://github.com/darkk/redsocks">RedSocks</a></li>
<li>RedSocks uses a socks server, <a href="http://www.inet.no/dante/">Dante</a>, as an upstream server on the cloud box</li>
<li>since the socks traffic is over TCP (inside the UDP OpenVPN tunnel) it uses MPTCP</li>
<li>having socks running, gives me quite the download speed, turning it off does not, hence the following tweet</li>
</ul>

<p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Hmmmm&hellip; If I have socks on, the Internet is fast 400mb/s+). But without socks, it&#39;s down to 60&hellip; Feck&hellip;</p>&mdash; Tiernan (@tiernano) <a href="https://twitter.com/tiernano/status/720186883905626112">April 13, 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<ul>
<li>I am also noticing that I am starting to hit the limits of my upstream VM. If downloading or uploading at speed, the processor cores (2 in the case of the box I am currently running) are pegged at pretty much 100% full&hellip; Well, 80ish, but that because the other 20% is being used by Dante. I am noticing I can hit a full 72Mbit/s up, but the max currently downloading is about 400, maybe 450&hellip; Need a faster box now&hellip;</li>
<li>I mentioned port 80 not being set over socks. That&rsquo;s because its redirected to Squid. Squid (in house) then uses Squid (in cloud) as a parent. There are 2 round-robin parents for squid, one on each OpenVPN connection IP address.</li>
<li>all other traffic (UDP, ICMP, etc.) are sent over the OpenVPN connection&hellip; currently only one is picked, but I have a cunning plan&hellip;</li>
</ul>

<p>{% youtube AsXKS8Nyu8Q %}</p>

<p>The cunning plan? Well, if I am reading the internet correctly, and I would like to think I am, I <em>think</em> <a href="https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing">ECMP</a>, or Equal Cost Multi-Path Routing, could help&hellip; Again, it’s a fledgling idea currently, and I am still reading the documentation, but if it works&hellip; Well&hellip; I not sure&hellip; let’s see&hellip;</p>
</span>
    </div><div id="post-tags">
    	<ul class="menu">
        <li class="row-item"><i class="fa fa-tags"></i>&nbsp;&nbsp;</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/guide" rel="tag" itemprop="url">guide</a>
    		</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/networking" rel="tag" itemprop="url">networking</a>
    		</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/ipv6" rel="tag" itemprop="url">i pv6</a>
    		</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/projects" rel="tag" itemprop="url">projects</a>
    		</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/howto" rel="tag" itemprop="url">how to</a>
    		</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/homelab" rel="tag" itemprop="url">home lab</a>
    		</li><li itemprop="relatedUrl" itemscope itemtype="http://schema.org/URL"><a class="row-item button" href="https://www.tiernanotoole.ie/tags/double_internet" rel="tag" itemprop="url">double internet</a>
    		</li></ul>
    </div></article>

  <nav id="post-nav" class="row"><a href="https://www.tiernanotoole.ie/post/installing-jekyll-on-bash-on-ubuntu-on-windows/" rel="prev" class="small-full medium-half pagination small-text-center medium-text-left"><span class="fa fa-chevron-circle-left"></span> Installing Jekyll on Bash On Ubuntu on Windows</a><a href="https://www.tiernanotoole.ie/post/2-cable-modems-double-speed-part-5/" rel="next" class="small-full medium-half pagination small-text-center medium-text-right">(Mad) Max Speed - The Road Warrior (Internet connection) (double speed internet Part 5) <span class="fa fa-chevron-circle-right"></span></a></nav></main>

        <aside class="row-item small-full medium-third right" itemscope itemtype="http://schema.org/WPSideBar">
  
  
  
	
  
	
	
</aside>

      </div>
      <footer class="row">
        <div class="small-full medium-half small-text-center medium-text-left medium-left row">
          <div class="small-full">
            <small>
              &copy; 2018
              <span itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <span itemprop="name">Tiernan&#39;s Comms Closet </span>
              </span>
            </small>
          </div>
          <div class="small-full row">
            
            
            <div class="row-item small-only-full">
              
                
  
  <a href="//www.iubenda.com/privacy-policy/21904595" class="iubenda-black  iubenda-embed" title="Privacy Policy">Privacy Policy</a>
<script type="text/javascript">
(function (w,d) {
  var loader = function () {
    var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0];
    s.src = "//cdn.iubenda.com/iubenda.js";
    tag.parentNode.insertBefore(s,tag);
  };
  if (w.addEventListener) {
    w.addEventListener("load", loader, false);
  } else if (w.attachEvent) {
    w.attachEvent("onload", loader);
  } else {
    w.onload = loader;
  }
})(window, document);
</script>

              
            </div>
            
            
          </div>
        </div>
        
        <div id="social-icons" class="row small-full medium-half small-text-center medium-text-right" style="align-self: center;">


</div>
      </footer>
    </div>
    
  </body>
</html>
