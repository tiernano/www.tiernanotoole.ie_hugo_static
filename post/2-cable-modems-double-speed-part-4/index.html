<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>2 Cable Modems = Double Speed? Part 4 | Tiernan&#39;s Comms Closet</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">2 Cable Modems = Double Speed? Part 4</span></h1>

<h2 class="date">2016/04/14</h2>
</div>

<main>
<p>[NOTE] This part 4 in a series of posts. The rest can be found <a href="https://www.tiernanotoole.ie/tag/Double%Internet/">here</a>.</p>

<p>So, this week I went in a completely different direction that I have been thinking recently&hellip;</p>

<p>So, the basic theory is as follows:</p>

<ul>
<li>I am still using MPTCP kernels on both upstream and local machine</li>
<li>now have 2 P2P UDP <a href="http://www.openvpn.net">OpenVPN</a> tunnels between house and cloud. Example config is <a href="https://gist.github.com/tiernano/09c6928d1d8f6752ea84fd895451bbe5">here</a></li>
<li>all TCP traffic (bar port 80) that hits the router in house is redirected to <a href="https://github.com/darkk/redsocks">RedSocks</a></li>
<li>RedSocks uses a socks server, <a href="http://www.inet.no/dante/">Dante</a>, as an upstream server on the cloud box</li>
<li>since the socks traffic is over TCP (inside the UDP OpenVPN tunnel) it uses MPTCP</li>
<li>having socks running, gives me quite the download speed, turning it off does not, hence the following tweet</li>
</ul>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Hmmmm... If I have socks on, the Internet is fast 400mb/s+). But without socks, it&#39;s down to 60... Feck...</p>&mdash; Tiernan (@tiernano) <a href="https://twitter.com/tiernano/status/720186883905626112?ref_src=twsrc%5Etfw">April 13, 2016</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<ul>
<li>I am also noticing that I am starting to hit the limits of my upstream VM. If downloading or uploading at speed, the processor cores (2 in the case of the box I am currently running) are pegged at pretty much 100% full&hellip; Well, 80ish, but that because the other 20% is being used by Dante. I am noticing I can hit a full 72Mbit/s up, but the max currently downloading is about 400, maybe 450&hellip; Need a faster box now&hellip;</li>
<li>I mentioned port 80 not being set over socks. That&rsquo;s because its redirected to Squid. Squid (in house) then uses Squid (in cloud) as a parent. There are 2 round-robin parents for squid, one on each OpenVPN connection IP address.</li>
<li>all other traffic (UDP, ICMP, etc.) are sent over the OpenVPN connection&hellip; currently only one is picked, but I have a cunning plan&hellip;</li>
</ul>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/AsXKS8Nyu8Q" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<p>The cunning plan? Well, if I am reading the internet correctly, and I would like to think I am, I <em>think</em> <a href="https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing">ECMP</a>, or Equal Cost Multi-Path Routing, could help&hellip; Again, it’s a fledgling idea currently, and I am still reading the documentation, but if it works&hellip; Well&hellip; I not sure&hellip; let’s see&hellip;</p>

</main>

  <footer>
  
  
  </footer>
  </body>
</html>

