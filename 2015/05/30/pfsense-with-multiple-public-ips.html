<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

<meta property="og:title" content="PFSense with Multiple Public IPs" />
<meta property="og:description" content="So, a few weeks back, i got my hands on a Hetzner Dedicated box. It has a quad core Xeon, 32Gb ram, 3x3Tb hdds, RAID controller and KVMoIP. one of the first thing i did was get myself a /29 IP pool (8 total, 6 usable IPs). There where already 3 IPs given to me: 1 for the KVM, one for the box itself, and 1 as the router for the IP block." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/2015/05/30/pfsense-with-multiple-public-ips.html" />



<meta property="article:published_time" content="2015-05-30T18:50:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-07-04T17:57:10&#43;01:00"/>












<meta itemprop="name" content="PFSense with Multiple Public IPs">
<meta itemprop="description" content="So, a few weeks back, i got my hands on a Hetzner Dedicated box. It has a quad core Xeon, 32Gb ram, 3x3Tb hdds, RAID controller and KVMoIP. one of the first thing i did was get myself a /29 IP pool (8 total, 6 usable IPs). There where already 3 IPs given to me: 1 for the KVM, one for the box itself, and 1 as the router for the IP block.">


<meta itemprop="datePublished" content="2015-05-30T18:50:00&#43;00:00" />
<meta itemprop="dateModified" content="2015-05-30T18:50:00&#43;00:00" />
<meta itemprop="wordCount" content="477">



<meta itemprop="keywords" content="Networking,VMWare,PFSense," />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PFSense with Multiple Public IPs"/>
<meta name="twitter:description" content="So, a few weeks back, i got my hands on a Hetzner Dedicated box. It has a quad core Xeon, 32Gb ram, 3x3Tb hdds, RAID controller and KVMoIP. one of the first thing i did was get myself a /29 IP pool (8 total, 6 usable IPs). There where already 3 IPs given to me: 1 for the KVM, one for the box itself, and 1 as the router for the IP block."/>






<meta name="generator" content="Hugo 0.42.1" />


    <base href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/">
    <link rel="canonical" href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/2015/05/30/pfsense-with-multiple-public-ips.html">
    <title>PFSense with Multiple Public IPs | Tiernan&#39;s Comms Closet</title>

    <!-- CSS -->
    <link href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/css/app.css" rel="stylesheet">

    

    

    
    


  </head>
  <body>

    <header class="nav">
      <div class="top-bar">
        <div class="row column">
          <div class="top-bar-left">
            <ul class="menu">
              <li><a href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/">
                  Tiernan's Comms Closet
                </a></li>
            </ul>
          </div>
          <div class="top-bar-right">
            <ul class="menu">
              <li class=""><a href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/">
                Home
              </a></li>
              
                
                  <li><a href="https://example.org">
                    Link 1
                  </a></li>
                
              
            </ul>
          </div>
        </div>
      </div>
    </header>

    <header class="blog-header">
      <div class="callout large">
        <div class="row column text-center">
          <h1>
            <a href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/" rel="home">Tiernan's Comms Closet</a>
          </h1>
          
            <p>
              Geek, Programmer, Photographer&hellip;
            </p>
          
        </div>
      </div>
    </header>

    <main>
      <div class="row" id="content">
        <div class="medium-8 columns">
          
  


  <div class="blog-post">
    <h3>
      <a href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/2015/05/30/pfsense-with-multiple-public-ips.html">PFSense with Multiple Public IPs</a>
    </h3>
    <div class="callout small">
      <small>
        <time datetime="2015-05-30T18:50:00Z">
          Sat May 30, 2015
        </time> by .
        
        Tags: 
  
    
      <a href="/www.tiernanotoole.ie_hugo_static/tags/networking">
        Networking
      </a>
  
    ,
    
      <a href="/www.tiernanotoole.ie_hugo_static/tags/vmware">
        VMWare
      </a>
  
    ,
    
      <a href="/www.tiernanotoole.ie_hugo_static/tags/pfsense">
        PFSense
      </a>
  

.
        <br>
        
          Share

    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftiernano.github.io%2fwww.tiernanotoole.ie_hugo_static%2f2015%2f05%2f30%2fpfsense-with-multiple-public-ips.html" title="Share on Facebook">
      Facebook
    </a>,


    <a href="https://plus.google.com/share?url=https%3a%2f%2ftiernano.github.io%2fwww.tiernanotoole.ie_hugo_static%2f2015%2f05%2f30%2fpfsense-with-multiple-public-ips.html" title="Share on Google+">
      Google+
    </a>,


    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ftiernano.github.io%2fwww.tiernanotoole.ie_hugo_static%2f2015%2f05%2f30%2fpfsense-with-multiple-public-ips.html" title="Share on LinkedIn">
      LinkedIn
    </a>,


    <a href="https://twitter.com/home?status=https%3a%2f%2ftiernano.github.io%2fwww.tiernanotoole.ie_hugo_static%2f2015%2f05%2f30%2fpfsense-with-multiple-public-ips.html" title="Tweet this">
      Twitter
    </a>


        
      </small>
    </div>
    <p>
      <p>So, a few weeks back, i got my hands on a <a href="http://www.hetzner.de/en">Hetzner</a> Dedicated box. It has a quad core Xeon, 32Gb ram, 3x3Tb hdds, RAID controller and KVMoIP. one of the first thing i did was get myself a /29 IP pool (8 total, 6 usable IPs). There where already 3 IPs given to me: 1 for the KVM, one for the box itself, and 1 as the router for the IP block.</p>

<p>So, i need to setup my own router, so i picked <a href="http://www.pfsense.org">PFSense</a> since its what i run in house. I gave it 2 network connections: 1 connected to the main network adapter on the VMWare ESXi box (public) and one to a virtual switch, which is only used by VMs. The public is the WAN link and it gets a static IP from Hetzner, and the virtual switch is then my &ldquo;LAN&rdquo; link. This allows me to have standard NATed network connections to any VM i have, but then, what do i do with those IPs?</p>

<p>So, after a lot of digging, i found the answer. So, this should help.</p>

<ul>
<li>Under firewall, click on Virtual IPs.</li>
<li>click the plus. I then selected IP alias, selected the WAN interface and set the IP to my first public IP i wanted to give. in my case, i was given a /29 block, and my first address was 176. This is the network address. I used 177. Likewise, my last address is 183, but that cannot be used either as its a broadcast address. give it a description and then hit OK. Repease for all IPs you want to use. TIP: Give each a meaningful description!</li>
<li>Next, click firewall, NAT and 1:1. Click the add button and select your interface as WAN. set the External Subnet IP as the one you want to use and your internal IP as the machine that will have it. Thats all i did on that screen&hellip;</li>
<li>Then go to Firewall, NAT, outbound&hellip; this is where things got complicated. Set the mode to &ldquo;Manual outbound NAT rule generation (AON - Advanced Outbound NAT)&rdquo; and click save.</li>
<li>Then create a new rule: Interface: WAN, Source, Network, IP of the internal machine and then under translation, under address select the IP you want to give it. If you followed my tip in step 2, you should see the descriptions in here.</li>
</ul>

<p>After saving everything and reloading the firewall, visiting a page like <a href="http://www.whatsmyip.org">WhatsMyIP</a> or <a href="http://icanhazip.com">ICanHazIP</a> should show you your public IP. You can then create firewall rules to allow access. Quick idea would be:</p>

<p>Firewall/Rules, Add, Interface WAN, Destination: Local IP you want to use, and give whatever &ldquo;normal&rdquo; rules you would (HTTP, lock down to source address, etc). Click apply and hitting that address using what ever method (SSH, HTTP, etc) should work.</p>

<p>YMMV, but hopefully this helps! Any questions, leave a comment.</p>

    </p>
    
    <hr>
  </div>

  
    <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
 var disqus_config = function () {
        this.page.url = "https://www.tiernanotoole.ie/2015/05/30/PFSense-with-multiple-public-ips.html";  
        this.page.identifier = "https://www.tiernanotoole.ie/2015/05/30/PFSense-with-multiple-public-ips.html"; 
    };
    (function() {  
        var d = document, s = d.createElement('script');
        s.src = '//tiernanotooleie.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();

</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  

<br>
<a href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/2015/05/30/pfsense-with-multiple-public-ips.html" class="hide-child link primary-color">“PFSense with Multiple Public IPs”</a> was last updated: 
July 4, 2018: <a  href="https://github.com/tiernano/www.tiernanotoole.ie_hugo//commit/8d5f59ad761a8d278319d6e47ff4356a1bcbac51">fixing Disqus... again... 
  (8d5f59a)</a>. Found an issue? <a href="https://github.com/tiernano/www.tiernanotoole.ie_hugo/edit/master/content/post/2015-05-30-PFSense-with-multiple-public-ips.markdown">Improve this page</a>

        </div>
          <div class="medium-3 columns" data-sticky-container>
  <div class="sticky" data-sticky data-anchor="content">

  
    <h4>About</h4>
    <p>homepage of Tiernan OToole, Geek, photographer, GeekPhotographer, and lazy git.</p>
  

  

  <h4>Recent Posts</h4>
  <ul>
    
      <li><a href="/www.tiernanotoole.ie_hugo_static/2018/07/02/playing-with-amd-epyc.html">
        Playing with AMD&rsquo;s Epyc
      </a></li>
    
      <li><a href="/www.tiernanotoole.ie_hugo_static/2018/04/01/as204994-own-ip-space-and-anycast.html">
        AS204994, Own IP Space and Anycast
      </a></li>
    
      <li><a href="/www.tiernanotoole.ie_hugo_static/2018/03/06/blogging-on-ipad.html">
        Blogging on an iPad Pro
      </a></li>
    
      <li><a href="/www.tiernanotoole.ie_hugo_static/2017/09/25/new-backup-plans.html">
        New Backup Plans
      </a></li>
    
      <li><a href="/www.tiernanotoole.ie_hugo_static/2017/08/16/testing-forestry.html">
        Testing Forestry
      </a></li>
    
  </ul>

  
    <h4>Links</h4>
    <ul>
      
        <li><a href="https://example.com">
          Link 1
        </a></li>
      
        <li><a href="https://example.org">
          Link 2
        </a></li>
      
    </ul>
  

  </div>
</div>

      </div>
    </main>

    <footer class="blog-footer">
      <div class="row column">
        <p>
          
          2018 Tiernan OToole
          
        </p>
        <p>
          <a href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/2015/05/30/pfsense-with-multiple-public-ips.html#">Back to top</a>
        </p>
      </div>
    </footer>

  <foot>

    <script src="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/js/app.js"></script>

  </foot>
  </body>
</html>
