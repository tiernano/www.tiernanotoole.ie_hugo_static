<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

<meta property="og:title" content="AS204994, Own IP Space and Anycast" />
<meta property="og:description" content="So, if you are reading this page, it is being delivered with the magic of Anycast&hellip; Well, technically, it was before, since i used Cloudflare, and it still is because of Cloudflare, but also because of my own ASN (As204994), some servers in different locations, and some magic, which i will explain a bit of in this post.
This all started late last year when i got my hands on an ASN and a /48 block of IPv6 addresses." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html" />



<meta property="article:published_time" content="2018-04-01T23:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-07-13T08:18:50&#43;01:00"/>












<meta itemprop="name" content="AS204994, Own IP Space and Anycast">
<meta itemprop="description" content="So, if you are reading this page, it is being delivered with the magic of Anycast&hellip; Well, technically, it was before, since i used Cloudflare, and it still is because of Cloudflare, but also because of my own ASN (As204994), some servers in different locations, and some magic, which i will explain a bit of in this post.
This all started late last year when i got my hands on an ASN and a /48 block of IPv6 addresses.">


<meta itemprop="datePublished" content="2018-04-01T23:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-04-01T22:55:06&#43;00:00" />
<meta itemprop="wordCount" content="421">



<meta itemprop="keywords" content="Networking,IPv6," />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="AS204994, Own IP Space and Anycast"/>
<meta name="twitter:description" content="So, if you are reading this page, it is being delivered with the magic of Anycast&hellip; Well, technically, it was before, since i used Cloudflare, and it still is because of Cloudflare, but also because of my own ASN (As204994), some servers in different locations, and some magic, which i will explain a bit of in this post.
This all started late last year when i got my hands on an ASN and a /48 block of IPv6 addresses."/>






<meta name="generator" content="Hugo 0.45" />


    <base href="https://www.tiernanotoole.ie/">
    <link rel="canonical" href="https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html">
    <title>AS204994, Own IP Space and Anycast | Tiernan&#39;s Comms Closet</title>

    <!-- CSS -->
    <link href="https://www.tiernanotoole.ie/css/app.css" rel="stylesheet">

    

    

    
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-220614-15', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
<script src="cloudinary-core-shrinkwrap.js" type="text/javascript"></script>

   
<script type="text/javascript">
    var appInsights = window.appInsights || function(a) {
        function b(a) {
            c[a] = function() {
                var b = arguments;
                c.queue.push(function() {
                    c[a].apply(c, b)
                })
            }
        }
        var c = {
                config: a
            },
            d = document,
            e = window;
        setTimeout(function() {
            var b = d.createElement("script");
            b.src = a.url || "https://az416426.vo.msecnd.net/scripts/a/ai.0.js", d.getElementsByTagName("script")[0].parentNode.appendChild(b)
        });
        try {
            c.cookie = d.cookie
        } catch (a) {}
        c.queue = [];
        for (var f = ["Event", "Exception", "Metric", "PageView", "Trace", "Dependency"]; f.length;) b("track" + f.pop());
        if (b("setAuthenticatedUserContext"), b("clearAuthenticatedUserContext"), b("startTrackEvent"), b("stopTrackEvent"), b("startTrackPage"), b("stopTrackPage"), b("flush"), !a.disableExceptionTracking) {
            f = "onerror", b("_" + f);
            var g = e[f];
            e[f] = function(a, b, d, e, h) {
                var i = g && g(a, b, d, e, h);
                return !0 !== i && c["_" + f](a, b, d, e, h), i
            }
        }
        return c
    }({
        instrumentationKey: "6ba6d0d3-8f0c-43c9-bea2-1547cb66b576"
    });

    window.appInsights = appInsights, appInsights.queue && 0 === appInsights.queue.length && appInsights.trackPageView();
</script>

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.0/dist/instantsearch.min.css">
    <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.0"></script>

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.0/dist/instantsearch-theme-algolia.min.css">

  </head>
  <body>

    <header class="nav">
      <div class="top-bar">
        <div class="row column">
          <div class="top-bar-left">
            <ul class="menu">
              <li><a href="https://www.tiernanotoole.ie/">
                  Tiernan's Comms Closet
                </a></li>
            </ul>
          </div>
          <div class="top-bar-right">
            <ul class="menu">
              <li class=""><a href="https://www.tiernanotoole.ie/">
                Home
              </a></li>
              
                
                  <li><a href="https://www.tiernanotoole.ie/computers/daily-carry.html">
                    Daily Carry
                  </a></li>
                
              
            </ul>
          </div>
        </div>
      </div>
    </header>

    <header class="blog-header">
      <div class="callout large">
        <div class="row column text-center">
          <h1>
            <a href="https://www.tiernanotoole.ie/" rel="home">Tiernan's Comms Closet</a>
          </h1>
          
            <p>
              Geek, Programmer, Photographer&hellip;
            </p>
          
        </div>
      </div>
    </header>

    <main>
      <div class="row" id="content">
        <div class="medium-8 columns">
          
  


  <div class="blog-post">
    <h3>
      <a href="https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html">AS204994, Own IP Space and Anycast</a>
    </h3>
    <div class="callout small">
      <small>
        <time datetime="2018-04-01T22:55:06Z">
          Sun Apr 1, 2018
        </time> by .
        
        Tags: 
  
    
      <a href="/tags/networking.html">
        Networking
      </a>
  
    ,
    
      <a href="/tags/ipv6.html">
        IPv6
      </a>
  

.
        <br>
        
          Share

    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.tiernanotoole.ie%2f2018%2f04%2f01%2fas204994-own-ip-space-and-anycast.html" title="Share on Facebook">
      Facebook
    </a>,


    <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.tiernanotoole.ie%2f2018%2f04%2f01%2fas204994-own-ip-space-and-anycast.html" title="Share on Google+">
      Google+
    </a>,


    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.tiernanotoole.ie%2f2018%2f04%2f01%2fas204994-own-ip-space-and-anycast.html" title="Share on LinkedIn">
      LinkedIn
    </a>,


    <a href="https://twitter.com/home?status=https%3a%2f%2fwww.tiernanotoole.ie%2f2018%2f04%2f01%2fas204994-own-ip-space-and-anycast.html" title="Tweet this">
      Twitter
    </a>


        
      </small>
    </div>
    <p>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-6435972961836580"
             data-ad-slot="5573260001"
             data-ad-format="auto"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>

      <p>So, if you are reading this page, it is being delivered with the magic of Anycast&hellip; Well, technically, it was before, since i used <a href="http://cloudflare.com">Cloudflare</a>, and it still is because of Cloudflare, but also because of my own ASN (<a href="http://as204994.net">As204994</a>), some servers in different locations, and some magic, which i will explain a bit of in this post.</p>

<p>This all started late last year when i got my hands on an ASN and a /48 block of IPv6 addresses. I had been reading stuff about BGP, routing, etc, and decided to go all in. it was quite cheap with the help of <a href="https://my.hostus.us/aff.php?aff=2152">HostUS</a>. All in, it was about $50 for the year. As part of the process, i needed 2 upstream providers to say they would accept my announcement. They were <a href="https://www.he.net">Hurricane Electric</a> though their <a href="http://www.tunnelbroker.com">Tunnel Broker</a> service, and <a href="https://www.vultr.com/?ref=6925432">Vultr </a>using a few of their VPSs.</p>

<p>After i got my space and ASN, i started to announce the V6 addresses over Vultr and Hurricane Electric, and all was good. I had 2 Vultr servers: 1 in London, UK, and one in New Jersey, USA. I had my home machine announce to HE, and then also link to both Vultr servers using <a href="https://www.zerotier.com">Zerotier</a>. All worked well, but due to some family issues, i never got around to putting it into production&hellip; till now.</p>

<p>Those 3 servers now share an IPv6 address on the loopback port. When you (well, Cloudflare) asks for that IP, the closet (network) with that IP responds, and the NGinx server on that box sends back the contents of the site. This site is hosted on each box, since its fully static, but both <a href="https://as204994.net">AS204994 </a>and <a href="https://tiernanotoole.net">TiernanOToole.net</a> are hosted in Ghost, so Dublin (my machine in the house) serves them, and both Lon1 and Nyc1 do proxying. so, most requests from the US are hitting the box in NYC and the ones in Europe share either Dub1 or Lon1. I have some tweaks to do with which servers will be running where, and may add more, but currently its working well.</p>

<p>So, how do you figure out what server responded? Simple. Open your Dev tools on your browser, go to network tab, refresh, and see the response headers for anything on this domain. You should see something like below.</p>


<a href="https://res.cloudinary.com/tiernanotoole/image/upload/w_auto,c_scale//v1530702268/responding-server.png"><img src="https://res.cloudinary.com/tiernanotoole/image/upload/w_auto,c_scale//v1530702268/responding-server.png" alt=""></a>



<p>Over the next while, i will be updating tiernanotoole.net with more details on how this works, and more stuff will end up on AS204994.net too. If anyone notices any weird and wonderful issues, shout. If you have more questions, shout.</p>

    </p>
    
    <hr>
  </div>

  
    
<div id="disqus_thread"></div>
<script>

 var disqus_config = function () {
        this.page.url = "https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html";  
        this.page.identifier = "https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html"; 
    };
(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://tiernanotooleie.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            


  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6435972961836580"
     data-ad-slot="1003459608"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<br>
<a href="https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html" class="hide-child link primary-color">“AS204994, Own IP Space and Anycast”</a> was last updated: 
July 13, 2018: <a  href="https://github.com/tiernano/www.tiernanotoole.ie_hugo//commit/c8b9f0df3f01f8a0f0f761335f0d3c75153d94ef">fixing aliases 
  (c8b9f0d)</a>. Found an issue? <a href="https://github.com/tiernano/www.tiernanotoole.ie_hugo/edit/master/content/post/2018-04-01-as204994-own-ip-space-and-anycast.md">Improve this page</a>

        </div>
          <div class="medium-3 columns" data-sticky-container>
  <div class="sticky" data-sticky data-anchor="content">

  
    <h4>About</h4>
    <p>homepage of Tiernan OToole, Geek, photographer, GeekPhotographer, and lazy git.</p>
  

    
  <div id="search-box">
    
  </div>

  <div id="hits">
    
  </div>


  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-6435972961836580"
       data-ad-slot="2480192807"
       data-ad-format="auto"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  

  <h4>Recent Posts</h4>
  <ul>
    
      <li><a href="/2018/07/24/finally-going-all-in-on-voip.html">
        Finally going all in on VoIP
      </a></li>
    
      <li><a href="/2018/07/05/auto-deploying-to-multiple-servers-with-github-and-webhooks.html">
        Auto deploying to multiple servers with GitHub and Webhooks
      </a></li>
    
      <li><a href="/2018/07/04/moving-the-site-to-hugo.html">
        Moving the site to Hugo
      </a></li>
    
      <li><a href="/2018/07/02/playing-with-amd-epyc.html">
        Playing with AMD&rsquo;s Epyc
      </a></li>
    
      <li><a href="/2018/04/01/as204994-own-ip-space-and-anycast.html">
        AS204994, Own IP Space and Anycast
      </a></li>
    
      <li><a href="/2018/03/06/blogging-on-ipad.html">
        Blogging on an iPad Pro
      </a></li>
    
      <li><a href="/2017/09/25/new-backup-plans.html">
        New Backup Plans
      </a></li>
    
      <li><a href="/2017/08/16/testing-forestry.html">
        Testing Forestry
      </a></li>
    
      <li><a href="/2017/05/06/vscode-with-powershell.html">
        VSCode and Markdown Monster with Powershell
      </a></li>
    
      <li><a href="/2017/05/05/zerotier-minio-update.html">
        Zerotier and Minio Followup
      </a></li>
    
  </ul>

  
    <h4>Links</h4>
    <ul>
      
        <li><a href="https://geekphotographer.com">
          Geek Photographer
        </a></li>
      
        <li><a href="https://www.tiernanotoole.ie/computers/daily-carry.html">
          Daily Carry
        </a></li>
      
    </ul>
  

  </div>
</div>

      </div>
    </main>

    <footer class="blog-footer">
      <div class="row column">
        <p>
          
          2018 Tiernan OToole
          
        </p>
        <p>
          <a href="https://www.tiernanotoole.ie/2018/04/01/as204994-own-ip-space-and-anycast.html#">Back to top</a>
        </p>
      </div>
    </footer>

  <foot>

    <script src="https://www.tiernanotoole.ie/js/app.js"></script>


    <script type="text/javascript">
      var vglnk = {
          key: 'aecb90add8b6f7192e42ddfa3e65b611'
      };
  
      (function(d, t) {
          var s = d.createElement(t);
          s.type = 'text/javascript';
          s.async = true;
          s.src = '//cdn.viglink.com/api/vglnk.js';
          var r = d.getElementsByTagName(t)[0];
          r.parentNode.insertBefore(s, r);
      }(document, 'script'));
  </script>
  
  <script type="text/javascript">
    const search = instantsearch({
    appId: '1T1XKYZNL5',
    apiKey: '7bbbf8cd1d237b7ef691bdf6d39d44e3',
    indexName: 'staticsite',
    routing: true
    });

    search.addWidget(
    instantsearch.widgets.hits({
      container: '#hits',
      templates: {
          empty: 'No results',
          item: '<div><a href="{{{permalink}}}">{{{ _highlightResult.title.value }}}</a></div>'
        }
      })
    );

     search.addWidget(
    instantsearch.widgets.searchBox({
      container: '#search-box',
      placeholder: 'Search for posts'
    })
    );

    search.start();
  </script>

  </foot>
  </body>
</html>
