<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Routeros on Tiernan&#39;s Comms Closet </title>
    <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/tags/routeros/</link>
    <description>Recent content in Routeros on Tiernan&#39;s Comms Closet </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 10 May 2015 18:40:00 +0000</lastBuildDate>
    <atom:link href="https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/tags/routeros/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>VLANs, Wifi and Mikrotik</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/vlans-wifi-and-mikrotik/</link>
      <pubDate>Sun, 10 May 2015 18:40:00 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/vlans-wifi-and-mikrotik/</guid>
      <description>&lt;p&gt;About a month ago, while i was recovering from surgery, i attended a Webinar on
&lt;a href=&#34;http://www.meraki.com&#34;&gt;Cisco Meraki&lt;/a&gt; devices. After the webinar, i was contacted by Maraki and given a &lt;a href=&#34;https://meraki.cisco.com/products/wireless/mr18&#34;&gt;MR18&lt;/a&gt; with a 3 year license, to play with and evaluate. So, i set it up in the house and all was good.&lt;/p&gt;

&lt;p&gt;Thing is, the wifi in the house was grand previously. I have a &lt;a href=&#34;http://routerboard.com/RB951G-2HnD&#34;&gt;Routerboard RB951G&lt;/a&gt; which does the job and has no issues. And because i am mostly offsite in the office i work, and because i need to remotely manage the network, the MR18 is going into the office from tomorrow morning. I may talk about the MR18 and the rest of the Meraki gear later on, but this is not that post. This post is about something the MR18 did, and i wanted to do on the RB951.&lt;/p&gt;

&lt;p&gt;So, the MR18 allows you to create multiple Wifi SSIDs, each with different encryption and security and can use different VLANs. Now, the Mikrotik does the same, but the VLANs stuff is not that easy to figure out. but essentially, what i needed to do was as follows:&lt;/p&gt;

&lt;p&gt;create your new wifi SSIDs:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/interface wireless
add master-interface=wlan1 name=wlan1.10 ssid=vlan10
add master-interface=wlan1 name=wlan1.20 ssid=vlan20
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;next, create your vlans. these need to be connected back to your main
ethernet connection. In the case of my RB951, there are 5 ethernet
ports. 1 is the gateway back to my Cisco switch and on to my &lt;a href=&#34;http://www.pfsense.org&#34;&gt;PFSense&lt;/a&gt; router. 2-5 are all slaves of number 1, which is a master. So, 1 is essentially a trunk network. So, vlans are created on that.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/interface vlan
add name=vlan10 interface=ether1-gateway name=ether1.10 vlan-id=10
add name=vlan20 interface=ether1-gateway name=ether1.20 vlan-id=20
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;next, a bridge to connect them&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/interface bridge
add name=vlan10
add name=vlan20
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and connect them to the bridge&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/interface bridge port
add bridge=vlan10 interface ether1.10
add bridge=vlan10 interface wlan1.10
add bridge=vlan20 interface ether1.20
add bridge=vlan20 interface wlan1.20
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And thats all i needed to do. I have a &lt;a href=&#34;https://www.sophos.com/en-us/products/free-tools/sophos-utm-home-edition.aspx&#34;&gt;Sophos UTM Home edition&lt;/a&gt; running on a vm for testing, which vlan10 is connected to. It has an upstream connection back to the PFSense box, which has it firewalled off and allows it outside the network, not nothing else. I am planning on doing this with other firewalls, just to do some testing with. This allows me to connect my phone or laptop, or any other wifi device, to a given wifi connection and then be on my way. I also have an older Dell PowerConnect switch, which, if i ever get around to it, will have multiple connections back to the Cisco and then allow physical devices to connect to different vlans.&lt;/p&gt;

&lt;p&gt;Any questions, comments, etc, leave a comment blow.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>IPv6 Firewall rules for MikroTik RouterOS</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/ipv6_firewall_rules_for_mikrotik_routeros/</link>
      <pubDate>Thu, 20 Dec 2012 11:09:06 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/ipv6_firewall_rules_for_mikrotik_routeros/</guid>
      <description>&lt;p&gt;After &lt;a href=&#34;http://tiernanotoole.ie/2012/12/19/ipv6_%2B_mikrotik_%2B_linux_%2B_windows.html&#34;&gt;yesterday&amp;rsquo;s post on IPv6 Networking in the house&lt;/a&gt;, I realized that all machines internally had publically facing IPv6 addresses! I started to panic, then went looking online, and found the following script:&lt;/p&gt;

&lt;script src=&#34;https://gist.github.com/4344701.js&#34;&gt;&lt;/script&gt;

&lt;p&gt;This script, when run on your RouterOS board, will allow Established and Related connections, allow outgoing connections, and drop anything incoming that has not been requested&amp;hellip; so, now everything inside the network should be more secured&amp;hellip; I am new to this IPv6 stuff, so I am still learning&amp;hellip; but, i am getting there&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>IPv6 &#43; MikroTik &#43; Linux &#43; Windows</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/ipv6_%2b_mikrotik_%2b_linux_%2b_windows/</link>
      <pubDate>Wed, 19 Dec 2012 16:24:07 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/ipv6_%2b_mikrotik_%2b_linux_%2b_windows/</guid>
      <description>&lt;p&gt;I have been wanting to setup an &lt;a href=&#34;http://en.wikipedia.org/wiki/Ipv6&#34;&gt;IPv6&lt;/a&gt; network for a while now, but never had the hardware or network to support it. My broadband Modem, a Cisco EPC3925, was pretty useless&amp;hellip; But with the advent of &lt;a href=&#34;http://tiernanotoole.ie/2012/10/02/Enabling-true-briding-mode-on-Cisco-EPC3925.html&#34;&gt;Bridging on the Cisco EPC3925&lt;/a&gt; it now works!&lt;/p&gt;

&lt;p&gt;The first thing i needed to do was setup a &lt;a href=&#34;http://www.tunnelbroker.net/&#34;&gt;Tunnel Broker Account&lt;/a&gt; with &lt;a href=&#34;http://www.he.net&#34;&gt;Hurricane Electric&lt;/a&gt;. I got a /64 block of IPv6 addresses, which should do me for a while&amp;hellip; :)&lt;/p&gt;

&lt;p&gt;Next, I followed the config example from the MikroTik Wiki Page: &lt;a href=&#34;http://wiki.mikrotik.com/wiki/Manual:My_First_IPv6_Network&#34;&gt;My First IPv6 Network&lt;/a&gt;. In my case, i only ran though most of router 1&amp;rsquo;s config, and did not create the &amp;ldquo;routing between segments&amp;rdquo; and &amp;ldquo;ospv-v3&amp;rdquo; backbone&amp;hellip; I did give my internal LAN port an IPv6 address, as well as an IPv4 address.&lt;/p&gt;

&lt;p&gt;Next, on my Windows Server machine, i gave it a static IPv6 address (since i dont have an IPv6 DHCP setup&amp;hellip; yet&amp;hellip;) and told it to use the IPv6 address i gave the RouteBoard as its gateway. Then i told it to use the &lt;a href=&#34;http://www.opendns.com&#34;&gt;OpenDNS&lt;/a&gt; &lt;a href=&#34;http://www.opendns.com/ipv6&#34;&gt;public IPv6&lt;/a&gt; address. I then visited &lt;a href=&#34;http://www.ipv6-test.com&#34;&gt;IPv6 Test&lt;/a&gt; and &lt;a href=&#34;http://ipv6.google.com&#34;&gt;Google&amp;rsquo;s IPv6 page&lt;/a&gt; to confirm connectivity&amp;hellip; SUCCESS!!!&lt;/p&gt;

&lt;p&gt;On my Linux box, I followed &lt;a href=&#34;http://knowledgelayer.softlayer.com/questions/468/Adding+IPv6+to+Ubuntu+systems&#34;&gt;Soflayer&amp;rsquo;s Adding an IPv6 IP&lt;/a&gt; tutorial.&lt;/p&gt;

&lt;p&gt;So far, so good&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>RouterOS Dynamic IP Updates</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/routeros_dynamic_ip_updates/</link>
      <pubDate>Mon, 19 Nov 2012 10:19:26 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/routeros_dynamic_ip_updates/</guid>
      <description>&lt;p&gt;I have been using a &lt;a href=&#34;http://www.mikrotik.com&#34;&gt;MikroTik&lt;/a&gt; &lt;a href=&#34;http://routerboard.com/RB750G&#34;&gt;RouterBoard RB750&lt;/a&gt; for a while now, and i love it! Over the weekend, i upgraded it to a &lt;a href=&#34;http://routerboard.com/RB1100&#34;&gt;RB1100&lt;/a&gt;. Its the same software running the device, but the device is faster (800Mhz PowerPC chip VS MIPS-BE at 680Mhz), has more memory (512Mb upgradable to 1.5Gb vs 32Mb) and more storage (think its 512Mb on board, plus 4Gb MicroSD card vs 32mb&amp;hellip;). It also has more ports (13 GigE VS 5) and 2 Switch Groups, which i have no idea what they do just yet&amp;hellip;&lt;/p&gt;

&lt;p&gt;Anyway, part of getting the RB1100 online and taking over from my existing router was getting Dynamic DNS updating. I use both &lt;a href=&#34;http://www.dyndns.org&#34;&gt;Dyndns&lt;/a&gt; and &lt;a href=&#34;http://no-ip.com&#34;&gt;NoIP&lt;/a&gt; for DNS, but I also like the look of &lt;a href=&#34;http://aws.amazon.com/route53&#34;&gt;Amazon Route 53&lt;/a&gt;. For updating NoIP, I am using the Alternitive script from &lt;a href=&#34;http://wiki.mikrotik.com/wiki/Dynamic_DNS_Update_Script_for_No-IP_DNS&#34;&gt;The Mikrotik Wiki&lt;/a&gt;. To get this to work with DynDNS, it would just be a matter of chaning the URL you point to&amp;hellip; I am going to write a web script which will sit internally on the network, use that instead of the No-IP url. When that script gets called, i can log the info, update DynDNS, NoIP and Router53 all in one go. I will be posting more about that soon&amp;hellip;&lt;/p&gt;

&lt;p&gt;And while we are on the topic of Scripting RouterOS, checkout the &lt;a href=&#34;http://wiki.mikrotik.com/wiki/Scripts&#34;&gt;Mikrotik Script Example Page&lt;/a&gt;. Lots of good stuff up there!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>RouterOS Using Host names in Firewall Rules</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/routeros_using_host_names_in_firewall_rules/</link>
      <pubDate>Fri, 12 Oct 2012 07:43:17 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/routeros_using_host_names_in_firewall_rules/</guid>
      <description>&lt;p&gt;As a follow up to yesterday&amp;rsquo;s post on &lt;a href=&#34;http://tiernanotoole.ie/2012/10/11/routeros_blocking_machine_access.html&#34;&gt;RouterOS Blocking Machine access to all but one IP&lt;/a&gt; I tought i would show how to add extra IPs to that list, without having a shedload of firewall filters.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;First things first, get your list of IPs you allow access to. In my case, i just did an NSLOOKUP on the name and got the IPs.&lt;/li&gt;
&lt;li&gt;Create an &amp;ldquo;Address List&amp;rdquo; in RouterOS. This can be done on the Web Interface by going to IP / Firewall / Address List and clicking Add. I had none previously, so i created a new rule, naming it &lt;a href=&#34;www.expressvpn.com/?referrer_email=tiernan@tiernanotoole.ie/&#34;&gt;ExpressVPN&lt;/a&gt; (the lads i use for VPN access) and added the first address.&lt;/li&gt;
&lt;li&gt;this is where things get interesting. for extra IP (for ExpressVPN, i have 4) you create a new address with the SAME name, but different IP.&lt;/li&gt;
&lt;li&gt;in your firewall rule, you should have either a src address or dst address. in my case, i had both, but this was a change for the dst address. I removed the address from the rule, i added it as a dst address list entry. If you have multiple address lists, you will see them here.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;to do this at the command prompt:&lt;/p&gt;

&lt;p&gt;{% gist 3877692 %}&lt;/p&gt;

&lt;p&gt;this will block any traffic, other than the IPs in the expressVPN address list, for the machine 192.168.0.123.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>RouterOS Blocking Machine access to all but one IP</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/routeros_blocking_machine_access/</link>
      <pubDate>Thu, 11 Oct 2012 13:09:20 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/routeros_blocking_machine_access/</guid>
      <description>&lt;p&gt;So, i have a machine on my network, which should be only connecting to the internet though a VPN. I needed to tell my RouterOS box to block all access, except to this said IP address&amp;hellip; The following &lt;em&gt;should&lt;/em&gt; do the trick&amp;hellip; YMMV&lt;/p&gt;

&lt;p&gt;{% gist 3871919 %}&lt;/p&gt;

&lt;p&gt;this will drop any packets from the srcaddress (IP address) that are not for destination dstaddress (IP address). in my case, dstaddress is the VPN server i want to connect to. So, in theory, all packets should just go though the VPN and not leak out in to the rest of the network&amp;hellip; again, still testing this so be careful!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MicroTik RouterOS VPN Setup</title>
      <link>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/microtik-routeros-vpn-setup/</link>
      <pubDate>Mon, 24 Sep 2012 00:00:00 +0000</pubDate>
      <guid>https://tiernano.github.io/www.tiernanotoole.ie_hugo_static/post/microtik-routeros-vpn-setup/</guid>
      <description>

&lt;p&gt;I have been running a &lt;a href=&#34;http://www.routerboard.com&#34;&gt;MikroTik RouterBoard&lt;/a&gt; in the house for a couple of months now (the &lt;a href=&#34;http://www.routerboard.com/RB750G&#34;&gt;RB750G&lt;/a&gt;) and I am very much loving the thing. But one thing you may need to do is setup VPN connections&amp;hellip; Here are some tips on how to create a VPN Server and Client on your RouterBoard.&lt;/p&gt;

&lt;h2 id=&#34;client-setup&#34;&gt;Client Setup&lt;/h2&gt;

&lt;p&gt;to setup a client, you need to do the following:&lt;/p&gt;

&lt;p&gt;{% gist 8581643 %}&lt;/p&gt;

&lt;p&gt;What does that all do? the first line creates an l2tp-client interface, pointing at &amp;ldquo;servername&amp;rdquo; with the username and password set. encryption, etc is enabled&amp;hellip; Line 2 then enables the client. Line 3 sets all traffic comming from networkaddress/24 (for example, 192.168.0.&lt;sup&gt;1&lt;/sup&gt;&amp;frasl;&lt;sub&gt;24&lt;/sub&gt;) to be sent though the VPN. any traffic going into networkaddress (same example) is not sent though the VPN. Line 4 creates a gateway, for all addresses (0.0.0.0/0) to use the VPN address. finally, NAT Masquerading is enabled on the VPN interface.&lt;/p&gt;

&lt;p&gt;there are more advanced things you can set above&amp;hellip; some examples I can think of are as follows:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;There should be no good reason to limit the amount of VPN connections you have&amp;hellip; in theory, you could have multiple&amp;hellip;&lt;/li&gt;
&lt;li&gt;for the mangle rule, set the src-address to a single machine in your network. that way, it gets VPN only connections. Also, you could set the dst-address to a single address or network to send only traffic going to a given server though the VPN&amp;hellip; Example would be Netflix US traffic to a US VPN server, BBC iPlayer traffic to a UK VPN, etc.&lt;/li&gt;
&lt;li&gt;the example above uses L2TP, but PPTP, SSTP and OpenVPN are also available.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;server-setup&#34;&gt;Server Setup&lt;/h2&gt;

&lt;p&gt;As mentioned above, L2TP, PPTP, SSTP and OpenVPN servers are available on RouterOs. Details on setting them up are available on MicroTik&amp;rsquo;s Wiki at the following locations:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://wiki.mikrotik.com/wiki/Manual:Interface/OVPN&#34;&gt;OpenVPN&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wiki.mikrotik.com/wiki/Manual:Interface/PPTP&#34;&gt;PPTP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wiki.mikrotik.com/wiki/Manual:Interface/L2TP&#34;&gt;L2TP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wiki.mikrotik.com/wiki/Manual:Interface/SSTP&#34;&gt;SSTP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
